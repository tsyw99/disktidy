pub mod models;
pub mod commands;
pub mod modules;
pub mod utils;

#[cfg_attr(mobile, tauri::mobile_entry_point)]
pub fn run() {
    // 初始化大文件扫描器
    modules::large_file_scanner::init_scanner();

    tauri::Builder::default()
        .plugin(tauri_plugin_shell::init())
        .plugin(tauri_plugin_opener::init())
        .plugin(tauri_plugin_dialog::init())
        .manage(commands::cleaner::CleanManager::new())
        .manage(commands::settings::SettingsState::new())
        .manage(commands::software_residue::ResidueScanState::new())
        .invoke_handler(tauri::generate_handler![
            commands::system::system_get_info,
            commands::system::system_get_disks,
            commands::system::system_get_cpu_info,
            commands::system::system_get_memory_info,
            commands::scan::disk_scan_start,
            commands::scan::disk_scan_pause,
            commands::scan::disk_scan_resume,
            commands::scan::disk_scan_cancel,
            commands::scan::disk_scan_progress,
            commands::scan::disk_scan_result,
            commands::scan::disk_scan_category_files,
            commands::scan::disk_scan_delete_files,
            commands::scan::disk_scan_delete_selected,
            commands::scan::disk_scan_clear_result,
            commands::cleaner::clean_preview,
            commands::cleaner::clean_files,
            commands::cleaner::clean_garbage_files,
            commands::cleaner::clean_duplicates,
            commands::cleaner::clean_cancel,
            commands::cleaner::clean_status,
            commands::cleaner::empty_recycle_bin,
            commands::cleaner::get_recycle_bin_info,
            commands::cleaner::check_file_safety,
            commands::cleaner::move_files_to_recycle_bin,
            commands::cleaner::generate_clean_report,
            commands::cleaner::export_report_json,
            commands::cleaner::export_report_html,
            commands::file_analyzer::analyze_garbage_files,
            commands::file_analyzer::analyze_garbage_by_category,
            commands::file_analyzer::get_garbage_categories,
            commands::file_analyzer::analyze_large_files,
            commands::file_analyzer::analyze_large_files_with_stats,
            commands::file_analyzer::get_large_file_details,
            commands::file_analyzer::find_duplicate_files,
            commands::file_analyzer::get_duplicate_suggestions,
            commands::file_analyzer::scan_junk_files,
            commands::file_analyzer::scan_junk_by_type,
            commands::file_analyzer::get_junk_file_types,
            commands::file_analyzer::junk_file_scan_start,
            commands::file_analyzer::junk_file_scan_pause,
            commands::file_analyzer::junk_file_scan_resume,
            commands::file_analyzer::junk_file_scan_cancel,
            commands::file_analyzer::junk_file_scan_progress,
            commands::file_analyzer::junk_file_scan_result,
            commands::file_analyzer::junk_file_scan_clear,
            commands::settings::settings_get,
            commands::settings::settings_update,
            commands::settings::settings_update_partial,
            commands::settings::settings_reset,
            commands::settings::settings_export,
            commands::settings::settings_import,
            commands::settings::rule_list,
            commands::settings::rule_get,
            commands::settings::rule_add,
            commands::settings::rule_update,
            commands::settings::rule_remove,
            commands::settings::rule_toggle,
            commands::settings::rule_test,
            commands::settings::rule_get_defaults,
            commands::app_cache::app_cache_scan_start,
            commands::app_cache::app_cache_scan_pause,
            commands::app_cache::app_cache_scan_resume,
            commands::app_cache::app_cache_scan_cancel,
            commands::app_cache::app_cache_scan_progress,
            commands::app_cache::app_cache_scan_result,
            commands::app_cache::app_cache_scan_clear,
            commands::app_config::get_app_config,
            commands::app_config::set_app_path,
            commands::app_config::remove_app_path,
            commands::app_config::is_app_configured,
            commands::app_config::get_all_configured_apps,
            commands::app_config::validate_path,
            commands::large_file::large_file_scan_start,
            commands::large_file::large_file_scan_pause,
            commands::large_file::large_file_scan_resume,
            commands::large_file::large_file_scan_cancel,
            commands::large_file::large_file_scan_get_progress,
            commands::large_file::large_file_scan_get_result,
            commands::large_file::large_file_scan_clear,
            commands::software_residue::residue_scan_start,
            commands::software_residue::residue_scan_pause,
            commands::software_residue::residue_scan_resume,
            commands::software_residue::residue_scan_cancel,
            commands::software_residue::residue_scan_progress,
            commands::software_residue::residue_scan_result,
            commands::software_residue::residue_scan_clear,
            commands::software_residue::residue_delete_items,
            commands::file_classifier::classify_files,
            commands::file_classifier::classify_disk,
            commands::file_classifier::start_classify_files,
            commands::file_classifier::cancel_classify_files,
            commands::driver::driver_get_list,
            commands::driver::driver_delete,
            commands::driver::driver_get_by_id,
        ])
        .run(tauri::generate_context!())
        .expect("error while running tauri application");
}
